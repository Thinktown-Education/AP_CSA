# 时间管理神器 —— 测试方案

版本：1.0

作者：自动生成（基于 `calendar.md` 的需求）

日期：2025-10-24

---

## 一、项目简介

“时间管理神器”是一款包含日历/日程与日记功能的应用，主要功能包括用户管理、按时间段获取日程、创建/修改/删除事件（含可选提醒）、以及日记的写/查看/修改/搜索/删除等。

## 二、测试目标与范围

- 目标：验证系统满足功能性需求并覆盖若干关键非功能性需求（基本性能、稳定性与安全性测试）。
- 范围：覆盖从 `calendar.md` 中提取的所有核心功能点；不对外部服务（如第三方通知服务）进行深度测试，仅验证对接正确性。

## 三、需求映射

功能需求：
1. 用户：注册/登录/认证
2. 获取日历/日程（按时间段查询）
3. 创建事件：标题、描述、时间、可选提醒
4. 日记管理：写、查看、修改、搜索、删除

隐含非功能需求：
- 输入校验（如非空标题、合理时间范围）
- 提醒的触发与记录
- 基本安全（未登录禁止写操作）
- 数据持久性与一致性

## 四、测试契约（简明）

- 输入：前端表单数据或 API 请求（事件 JSON、日记文本、查询时间段）。
- 输出：HTTP 状态码与 JSON 响应；前端 UI 提示；数据库中对应记录的变更。
- 错误处理：对无效输入返回 4xx，未授权访问返回 401/403，内部错误返回 5xx 并记录日志。

成功判定：所有 P0 用例通过，关键安全测试无高危问题，提醒机制在测试环境下能按预期触发。

说明：测试环境默认为单机开发服务器与本地数据库，提醒可使用短间隔（如 1 分钟）以便测试。

## 五、优先级划分

- P0（必须）：用户认证、创建事件、按时间段获取日程、日记写/查看/删除、日记搜索、未登录禁止写操作。
- P1（重要）：事件提醒、事件修改、日记修改与复杂搜索、基本安全（XSS 输入过滤）。
- P2（可选）：时区/夏令时复杂情况、性能/负载测试、离线恢复。

## 六、测试环境与工具建议

- 浏览器：Chrome（用于手动与自动化 UI 测试）
- 接口测试：Postman / HTTPie
- 端到端自动化（可选）：Playwright / Selenium
- 性能测试（可选）：k6 / JMeter
- 数据库：与项目一致（SQLite/MySQL/Postgres）

## 七、测试数据示例

- 用户账号：
  - userA@example.com / Aa123456（普通用户）
  - userB@example.com / Bb123456（交互测试）
  - locked@example.com（未激活/锁定用户，用于边界测试）
- 事件示例：
  - E1：标题“数学复习”，描述“做题2小时”，开始 2025-11-01 10:00，结束 2025-11-01 12:00，提醒 15 分钟前
  - E2：标题“午餐”，开始 2025-11-01 12:00（无结束时间）
  - E3：无标题（非法）、开始时间晚于结束时间（非法）
- 日记示例：
  - D1：普通文本日记
  - D2：含特殊字符与 HTML 片段（用于 XSS 测试）
  - D3：长文本（>10k 字节，用于性能边界）

## 八、功能测试用例（示例，建议表格化）

每条用例应包含：ID、名称、前置条件、步骤、输入、预期结果、优先级、执行者、实际结果、状态、备注

- TC-F01：用户注册与登录（P0）
  - 前置：无
  - 步骤：注册合法邮箱与密码 -> 登录
  - 预期：注册成功，可登录并获得会话/Token

- TC-F02：创建事件（正常，P0）
  - 前置：userA 已登录
  - 步骤：新建事件 E1 -> 提交
  - 预期：返回 201，数据库新增 E1，前端在对应日期显示

- TC-F03：创建事件：缺少标题（负例，P0）
  - 预期：返回 400，前端提示标题不能为空

- TC-F04：创建事件：开始时间晚于结束时间（负例，P0）
  - 预期：返回 400 或表单校验阻止提交

- TC-F05：按时间段获取日程（P0）
  - 前置：数据库包含 E1/E2
  - 步骤：调用 /events?start=2025-11-01T00:00&end=2025-11-02T00:00
  - 预期：返回包含 E1 与 E2 的列表，状态 200

- TC-F06：修改事件（P1）
  - 预期：事件被更新，数据库记录变更

- TC-F07：删除事件（P1）
  - 预期：事件被删除或标记为已删除，不再返回

- TC-F08：事件提醒触发（P1）
  - 前置：创建短间隔提醒（如 1 分钟）
  - 预期：提醒按时触发（可通过日志或前端通知验证）

- TC-F09：日记 CRUD（P0）
  - 步骤：写日记 D1 -> 查看 -> 修改 -> 删除
  - 预期：各操作返回成功，数据库同步更新

- TC-F10：日记搜索（P0）
  - 步骤：搜索关键词，包含特殊字符测试
  - 预期：返回匹配日记，特殊字符被正确处理或给出错误提示

- TC-F11：XSS 与输入校验（P1）
  - 步骤：提交含脚本的输入（如 "<script>alert(1)</script>")
  - 预期：输入被转义或拒绝，页面不执行脚本

- TC-F12：未登录访问受保护接口（P0）
  - 步骤：未登录调用创建/修改/删除接口
  - 预期：返回 401/403，操作被拒绝

## 九、非功能测试（示例）

- NF-T01：性能（简化）
  - 目标：单用户并发 5 次请求下，获取日程 95% 请求 < 300ms
  - 方法：脚本重复请求并收集 95 百分位

- NF-T02：并发稳定性
  - 目标：并发 50 请求下错误率 < 1%

- NF-T03：任务调度稳定性
  - 目标：提醒机制在长时间运行或多次触发下不丢失事件

- NF-T04：可用性（手动）
  - 目标：测试者能在短时间内完成核心任务（创建并查看事件），记录耗时与易用性问题

## 十、边界与异常情况

- 重叠事件（同一时间段内）
- 大量事件分页（如 1000 条）
- 提醒时间在过去（应拒绝或立即处理）
- 时区与夏令时（若支持）
- 网络断开后的恢复策略（若实现）

## 十一、验收标准

- P0 用例全部通过并在报告中记录证据（日志/截图/请求响应片段）。
- 未授权访问被正确拒绝。
- XSS/输入校验通过（无可执行脚本）。
- 提醒按预期被触发（在模拟环境中验证）。

## 十二、执行与报告建议（IB IA 写作友好）

- 将测试用例导出为表格（Excel/CSV），包含每条用例的执行证据（截图/日志/响应片段）。
- 报告中选择若干代表性用例展示详细结果（包含失败分析）。
- 对提醒与安全测试保留详细日志作为证据。

## 十三、后续可选项（我可帮忙实现）

- 导出用例为 CSV/Excel。
- 生成 Playwright 或 Postman 的基础测试脚本模板（覆盖 3-5 个关键用例）。
- 根据你的 IA 报告需要，制作 2-3 个“实验记录”示例，包含截图占位与说明。

---

文件已生成。如需我把测试用例表格化或生成自动化脚本，请告诉我你希望的格式（CSV / Excel /Postman /Playwright）。
